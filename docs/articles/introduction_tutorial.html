<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introductory tutorial • datathin</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introductory tutorial">
<meta property="og:description" content="datathin">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">datathin</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Welcome</a>
</li>
<li>
  <a href="../articles/introduction_tutorial.html">Introductory tutorial</a>
</li>
<li>
  <a href="../articles/unsupervised_tutorial.html">Unsupervised learning tutorial</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/anna-neufeld/datathin/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introductory tutorial</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/anna-neufeld/datathin/blob/HEAD/vignettes/introduction_tutorial.Rmd" class="external-link"><code>vignettes/introduction_tutorial.Rmd</code></a></small>
      <div class="hidden name"><code>introduction_tutorial.Rmd</code></div>

    </div>

    
    
<p>Welcome to the <code>datathin</code> package. In this tutorial, we will show how random variables from different distributions can be split into independent training and test components. For more details, see our pre-print. For information on how to use <code>datathin</code> for tasks such as model evaluation or inference after model selection, see our forthcoming tutorials.</p>
<p>To get started, ensure that you have downloaded the package. Make sure that <code>remotes</code> is installed by running <code>install.packages("remotes")</code>, then type</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"anna-neufeld/datathin"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/anna-neufeld/datathin" class="external-link">datathin</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="poisson">Poisson<a class="anchor" aria-label="anchor" href="#poisson"></a>
</h2>
<p>The Poisson distribution is simple, because there is only one parameter.</p>
<p>We first generate a vector of 10,000 <span class="math inline">\(Poisson(7)\)</span> random variables.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat.thin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"poisson"</span>, epsilon<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">dat.thin</span><span class="op">$</span><span class="va">Xtr</span></span>
<span><span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">dat.thin</span><span class="op">$</span><span class="va">Xte</span></span></code></pre></div>
<p>We now verify several properties of the data thinning operation.</p>
<p>First, we verify that the expected value of dat.train is <span class="math inline">\(0.3 \times 7\)</span> and the expected value of dat.test is <span class="math inline">\(0.7 \times 7\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">## [1] 7.0001</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span></span>
<span><span class="co">## [1] 2.1028</span></span>
<span><span class="fl">0.3</span><span class="op">*</span><span class="fl">7</span></span>
<span><span class="co">## [1] 2.1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.test</span><span class="op">)</span></span>
<span><span class="co">## [1] 4.8973</span></span>
<span><span class="fl">0.7</span><span class="op">*</span><span class="fl">7</span></span>
<span><span class="co">## [1] 4.9</span></span></code></pre></div>
<p>We next verify that <code>dat.train</code> and <code>dat.test</code> are independent, and that they sum to <code>dat</code>. Throughout this document, we use small empirical correlations as evidence of independence.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">+</span><span class="va">dat.test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat.train</span>, <span class="va">dat.test</span><span class="op">)</span></span>
<span><span class="co">##             [,1]</span></span>
<span><span class="co">## [1,] 0.006371561</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exponential">Exponential<a class="anchor" aria-label="anchor" href="#exponential"></a>
</h2>
<p>We next consider the exponential distribution.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">100000</span>, rate<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">## [1] 2.994101</span></span></code></pre></div>
<p>For this distribution, we demonstrate how to create multiple indendent folds of data using the <code>multithin</code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">folds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multithin.html">multithin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"exponential"</span>, nfolds<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>Here, <code>folds</code> is a list with 5 elements. Each list element stores one fold of data, which in this case means a vector of length 100000.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">folds</span><span class="op">)</span></span>
<span><span class="co">## [1] 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">folds</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">## [1] 100000</span></span></code></pre></div>
<p>We can verify that, for <span class="math inline">\(m=1,\ldots,5\)</span>, the <span class="math inline">\(m\)</span>th fold of data is independent of the sum of the remaining folds, and that it has mean <span class="math inline">\(\frac{1}{5} \times 3\)</span>, while the remainder has mean <span class="math inline">\(\frac{4}{5} \times 3\)</span>. Once again, we use small empirical correlations as evidence of independence.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">m</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"-------"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"fold"</span>, <span class="va">m</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">folds</span><span class="op">[[</span><span class="va">m</span><span class="op">]</span><span class="op">]</span></span>
<span>  <span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">-</span> <span class="va">folds</span><span class="op">[[</span><span class="va">m</span><span class="op">]</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.test</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">/</span><span class="fl">5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat.test</span>, <span class="va">dat.train</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">## [1] "-------"</span></span>
<span><span class="co">## [1] "fold 1"</span></span>
<span><span class="co">## [1] 0.5988201 0.5990102</span></span>
<span><span class="co">## [1] 2.39528 2.39509</span></span>
<span><span class="co">## [1] 0.000691018</span></span>
<span><span class="co">## [1] "-------"</span></span>
<span><span class="co">## [1] "fold 2"</span></span>
<span><span class="co">## [1] 0.5988201 0.6065097</span></span>
<span><span class="co">## [1] 2.395280 2.387591</span></span>
<span><span class="co">## [1] 0.001430393</span></span>
<span><span class="co">## [1] "-------"</span></span>
<span><span class="co">## [1] "fold 3"</span></span>
<span><span class="co">## [1] 0.5988201 0.5941541</span></span>
<span><span class="co">## [1] 2.395280 2.399946</span></span>
<span><span class="co">## [1] 0.0003254383</span></span>
<span><span class="co">## [1] "-------"</span></span>
<span><span class="co">## [1] "fold 4"</span></span>
<span><span class="co">## [1] 0.5988201 0.5962563</span></span>
<span><span class="co">## [1] 2.395280 2.397844</span></span>
<span><span class="co">## [1] -0.0002356422</span></span>
<span><span class="co">## [1] "-------"</span></span>
<span><span class="co">## [1] "fold 5"</span></span>
<span><span class="co">## [1] 0.5988201 0.5981703</span></span>
<span><span class="co">## [1] 2.39528 2.39593</span></span>
<span><span class="co">## [1] -0.0003506916</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="normal-distribution">Normal distribution<a class="anchor" aria-label="anchor" href="#normal-distribution"></a>
</h2>
<p>We now show an example of thinning the normal distribution. This is slightly more complicated, as the <span class="math inline">\(N(\mu, \sigma^2)\)</span> distribution has two parameters, and in order to apply data thinning the parameter <span class="math inline">\(\sigma^2\)</span> must be known.</p>
<p>We start by generating data from a <span class="math inline">\(N(5, 2)\)</span> distribution and applying <code>datathin</code> with <span class="math inline">\(\epsilon = 0.5\)</span>. This time, we let our dataset <code>dat</code> be a matrix with dimensions <span class="math inline">\(10000 \times 10\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">*</span><span class="fl">10</span>, mean<span class="op">=</span><span class="fl">5</span>, sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">10000</span><span class="op">)</span></span></code></pre></div>
<p>We first apply data thinning assuming that <span class="math inline">\(\sigma^2=2\)</span> is known. This is passed in as the <code>arg</code> parameter. We can see that, after applying data thinning, each column of the training set is independent of each column in the test set (once again, we are using small empirical correlations as evidence of independence).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"normal"</span>, epsilon<span class="op">=</span><span class="fl">0.5</span>, arg<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">Xtr</span></span>
<span><span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">Xte</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">[</span>,<span class="va">u</span><span class="op">]</span>, <span class="va">dat.test</span><span class="op">[</span>,<span class="va">u</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##  [1] -0.0054039893  0.0170518402  0.0092961249 -0.0145605012  0.0209949092</span></span>
<span><span class="co">##  [6] -0.0004228364  0.0055731047  0.0219910992 -0.0109886560  0.0005400666</span></span></code></pre></div>
<p>The parameter <code>arg</code> must either be a scalar (in which case it is assumed that all elements of the data matrix have the same value of <span class="math inline">\(\sigma^2\)</span>), or its dimensions must match that of the data.</p>
<p>We now explore the impact of using the “wrong” value of <span class="math inline">\(\sigma^2\)</span> while splitting. We generate a dataset with <span class="math inline">\(100,000\)</span> rows and <span class="math inline">\(3\)</span> columns. In the first column, the data are from a <span class="math inline">\(N(5, 0.1)\)</span> distribution. In the second column, they are from a <span class="math inline">\(N(5,2)\)</span> distribution. In the final column, they are from a <span class="math inline">\(N(5,20)\)</span> distribution.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100000</span>, mean<span class="op">=</span><span class="fl">5</span>, sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100000</span>, mean<span class="op">=</span><span class="fl">5</span>, sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100000</span>, mean<span class="op">=</span><span class="fl">5</span>, sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>First, we datathin but we incorrectly that all items in the matrix have <span class="math inline">\(\sigma^2=2\)</span>. We see that we have negative correlation between the training and test sets in the first column (where we used a value of <span class="math inline">\(\sigma^2\)</span> that was too big), no correlation in the second column (where we used the correct value of <span class="math inline">\(\sigma^2\)</span>), and positive correlation in the last column (where we used a value of <span class="math inline">\(\sigma^2\)</span> that was too small). See our preprint for further explanation of this property.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"normal"</span>, epsilon<span class="op">=</span><span class="fl">0.5</span>, arg<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">Xtr</span></span>
<span><span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">Xte</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">[</span>,<span class="va">u</span><span class="op">]</span>, <span class="va">dat.test</span><span class="op">[</span>,<span class="va">u</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] -0.9051753032  0.0001091388  0.8181117290</span></span></code></pre></div>
<p>To remedy the situation, we must let <code>arg</code> be a matrix that stores the correct <span class="math inline">\(\sigma^2\)</span> values.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">good_args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">100000</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">100000</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">100000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"normal"</span>, epsilon<span class="op">=</span><span class="fl">0.5</span>, arg<span class="op">=</span><span class="va">good_args</span><span class="op">)</span></span>
<span><span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">Xtr</span></span>
<span><span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">Xte</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">[</span>,<span class="va">u</span><span class="op">]</span>, <span class="va">dat.test</span><span class="op">[</span>,<span class="va">u</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1]  0.0032153025 -0.0004907226  0.0069561926</span></span></code></pre></div>
<p>We quickly note that an error will be thrown if <code>arg</code> is not a scalar and its dimensions do not match those of the data. The following code results in an error:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"normal"</span>, epsilon<span class="op">=</span><span class="fl">0.5</span>, arg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">2</span>,<span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="negative-binomial">Negative binomial<a class="anchor" aria-label="anchor" href="#negative-binomial"></a>
</h2>
<p>We generate data from a negative binomial distribution. We use the mean and overdispersion parameterization of the negative binomial distribution.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom</a></span><span class="op">(</span><span class="fl">100000</span>, size<span class="op">=</span><span class="fl">7</span>, mu <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"negative binomial"</span>, epsilon <span class="op">=</span> <span class="fl">0.2</span>, arg<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">Xtr</span></span>
<span><span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">Xte</span></span>
<span><span class="fl">0.2</span><span class="op">*</span><span class="fl">6</span></span>
<span><span class="co">## [1] 1.2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span></span>
<span><span class="co">## [1] 1.20032</span></span>
<span><span class="fl">0.8</span><span class="op">*</span><span class="fl">6</span></span>
<span><span class="co">## [1] 4.8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.test</span><span class="op">)</span></span>
<span><span class="co">## [1] 4.83373</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat.train</span>, <span class="va">dat.test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.003394014</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="gamma">Gamma<a class="anchor" aria-label="anchor" href="#gamma"></a>
</h2>
<p>We verify the same properties as above, assuming that the shape parameter is known.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">10000</span>, shape<span class="op">=</span><span class="fl">12</span>, rate<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">## [1] 5.991792</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"gamma"</span>, epsilon <span class="op">=</span> <span class="fl">0.5</span>, arg<span class="op">=</span><span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">Xtr</span></span>
<span><span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">Xte</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span></span>
<span><span class="co">## [1] 2.988115</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.test</span><span class="op">)</span></span>
<span><span class="co">## [1] 3.003678</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat.train</span>, <span class="va">dat.test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] -0.01168888</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="binomial">Binomial<a class="anchor" aria-label="anchor" href="#binomial"></a>
</h2>
<p>We verify the same properties as above, assuming that the size parameter is known. Note that, if we want to use <span class="math inline">\(\epsilon=0.5\)</span>, the size parameter of the binomial distribution must be an even number.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">16</span>, <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">## [1] 4.0169</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"binomial"</span>, epsilon <span class="op">=</span> <span class="fl">0.5</span>, arg<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">Xtr</span></span>
<span><span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">Xte</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span></span>
<span><span class="co">## [1] 1.9963</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.test</span><span class="op">)</span></span>
<span><span class="co">## [1] 2.0206</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat.train</span>, <span class="va">dat.test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] -0.003082758</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="multivariate-normal-and-multinomial-">Multivariate normal and multinomial.<a class="anchor" aria-label="anchor" href="#multivariate-normal-and-multinomial-"></a>
</h2>
<p>Implementations and demonstrations for these multivariate distributions are coming soon!</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Anna Neufeld, Ameer Dharamshi.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
