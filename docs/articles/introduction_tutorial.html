<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introductory tutorial • datathin</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introductory tutorial">
<meta property="og:description" content="datathin">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">datathin</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Welcome</a>
</li>
<li>
  <a href="../articles/introduction_tutorial.html">Introductory tutorial</a>
</li>
<li>
  <a href="../articles/unsupervised_tutorial.html">Unsupervised learning tutorial</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/anna-neufeld/datathin/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Introductory tutorial</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/anna-neufeld/datathin/blob/HEAD/vignettes/introduction_tutorial.Rmd" class="external-link"><code>vignettes/introduction_tutorial.Rmd</code></a></small>
      <div class="hidden name"><code>introduction_tutorial.Rmd</code></div>

    </div>

    
    
<p>Welcome to the <code>datathin</code> package. In this tutorial, we
will show how random variables from different distributions can be split
into independent training and test components. For more details, see our
pre-print. For information on how to use <code>datathin</code> for tasks
such as model evaluation or inference after model selection, see our
forthcoming tutorials.</p>
<p>To get started, ensure that you have downloaded the package. Make
sure that <code>remotes</code> is installed by running
<code>install.packages("remotes")</code>, then type</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"anna-neufeld/datathin"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/anna-neufeld/datathin" class="external-link">datathin</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://mvtnorm.R-forge.R-project.org" class="external-link">mvtnorm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/twolodzko/extraDistr" class="external-link">extraDistr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="poisson">Poisson<a class="anchor" aria-label="anchor" href="#poisson"></a>
</h2>
<p>The Poisson distribution is simple, because there is only one
parameter.</p>
<p>We first generate a vector of 10,000 <span class="math inline">\(Poisson(7)\)</span> random variables.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Poisson.html" class="external-link">rpois</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">7</span><span class="op">)</span></span></code></pre></div>
<p>Next, we thin the data with the <code>datathin</code> function. The
output of <code>datathin</code> is an array where the last dimension
indexes the folds of the thinned data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat.thin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"poisson"</span>, epsilon<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">dat.thin</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">dat.thin</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span></span></code></pre></div>
<p>We now verify several properties of the data thinning operation.</p>
<p>First, we verify that the expected value of dat.train is <span class="math inline">\(0.3 \times 7\)</span> and the expected value of
dat.test is <span class="math inline">\(0.7 \times 7\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">## [1] 7.0001</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span></span>
<span><span class="co">## [1] 2.1028</span></span>
<span><span class="fl">0.3</span><span class="op">*</span><span class="fl">7</span></span>
<span><span class="co">## [1] 2.1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.test</span><span class="op">)</span></span>
<span><span class="co">## [1] 4.8973</span></span>
<span><span class="fl">0.7</span><span class="op">*</span><span class="fl">7</span></span>
<span><span class="co">## [1] 4.9</span></span></code></pre></div>
<p>We next verify that <code>dat.train</code> and <code>dat.test</code>
are independent, and that they sum to <code>dat</code>. Throughout this
document, we use small empirical correlations as evidence of
independence.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">+</span><span class="va">dat.test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat.train</span>, <span class="va">dat.test</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.006371561</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exponential">Exponential<a class="anchor" aria-label="anchor" href="#exponential"></a>
</h2>
<p>We next consider the exponential distribution.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">100000</span>, rate<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">## [1] 4.990168</span></span></code></pre></div>
<p>For this distribution, we will create 5 independent, symmetric folds
of the <code>K</code> argument in the <code>datathin</code>
function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">folds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"exponential"</span>, K<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<p>Here, <code>folds</code> is a <span class="math inline">\(100,000
\times 1 \times 5\)</span> array.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">folds</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="co">## [1] 5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">folds</span><span class="op">[</span>,,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">## [1] 100000</span></span></code></pre></div>
<p>We can verify that, for <span class="math inline">\(m=1,\ldots,5\)</span>, the <span class="math inline">\(m\)</span>th fold of data is independent of the
sum of the remaining folds, and that it has mean <span class="math inline">\(\frac{1}{5} \times 5 = 1\)</span>, while the
remainder has mean <span class="math inline">\(\frac{4}{5} \times 5 =
4\)</span>. Once again, we use small empirical correlations as evidence
of independence.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">m</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"-------"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"fold"</span>, <span class="va">m</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">folds</span><span class="op">[</span>,,<span class="va">m</span><span class="op">]</span></span>
<span>  <span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">dat</span> <span class="op">-</span> <span class="va">folds</span><span class="op">[</span>,,<span class="va">m</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Test set mean"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.test</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Training set mean:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Sample correlation:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat.test</span>, <span class="va">dat.train</span><span class="op">)</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">## [1] "-------"</span></span>
<span><span class="co">## [1] "fold 1"</span></span>
<span><span class="co">## [1] "Test set mean 0.985"</span></span>
<span><span class="co">## [1] "Training set mean: 4.005"</span></span>
<span><span class="co">## [1] "Sample correlation: 0.0062"</span></span>
<span><span class="co">## [1] "-------"</span></span>
<span><span class="co">## [1] "fold 2"</span></span>
<span><span class="co">## [1] "Test set mean 1"</span></span>
<span><span class="co">## [1] "Training set mean: 3.991"</span></span>
<span><span class="co">## [1] "Sample correlation: 0.0063"</span></span>
<span><span class="co">## [1] "-------"</span></span>
<span><span class="co">## [1] "fold 3"</span></span>
<span><span class="co">## [1] "Test set mean 0.999"</span></span>
<span><span class="co">## [1] "Training set mean: 3.991"</span></span>
<span><span class="co">## [1] "Sample correlation: -0.001"</span></span>
<span><span class="co">## [1] "-------"</span></span>
<span><span class="co">## [1] "fold 4"</span></span>
<span><span class="co">## [1] "Test set mean 1.002"</span></span>
<span><span class="co">## [1] "Training set mean: 3.988"</span></span>
<span><span class="co">## [1] "Sample correlation: 7e-04"</span></span>
<span><span class="co">## [1] "-------"</span></span>
<span><span class="co">## [1] "fold 5"</span></span>
<span><span class="co">## [1] "Test set mean 1.004"</span></span>
<span><span class="co">## [1] "Training set mean: 3.986"</span></span>
<span><span class="co">## [1] "Sample correlation: 0.0011"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="gamma">Gamma<a class="anchor" aria-label="anchor" href="#gamma"></a>
</h2>
<p>The results for the exponential family can be extended to any gamma
distribution where the shape parameter is known. To thin the gamma
distribution we will provide the shape to the <code>datathin</code>
function using the <code>arg</code> argument. Note that by omitting the
<code>epsilon</code> parameter, we are requesting symmetric training and
test sets.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">10000</span>, shape<span class="op">=</span><span class="fl">12</span>, rate<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">## [1] 5.992822</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"gamma"</span>, arg<span class="op">=</span><span class="fl">12</span><span class="op">)</span></span>
<span><span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span></span>
<span><span class="co">## [1] 3.004014</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.test</span><span class="op">)</span></span>
<span><span class="co">## [1] 2.988808</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat.train</span>, <span class="va">dat.test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] -0.01479233</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="normal-distribution">Normal distribution<a class="anchor" aria-label="anchor" href="#normal-distribution"></a>
</h2>
<p>We now show an example of thinning the normal distribution. This is
slightly more complicated, as the <span class="math inline">\(N(\mu,
\sigma^2)\)</span> distribution has two parameters. We will demonstrate
data thinning strategies when either the mean <span class="math inline">\(\mu\)</span> or the variance <span class="math inline">\(\sigma^2\)</span> are unknown, and the other is
known.</p>
<p>We start by generating data from a <span class="math inline">\(N(5,
2)\)</span> distribution. This time, we let our dataset <code>dat</code>
be a matrix with dimensions <span class="math inline">\(10000 \times
10\)</span>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">*</span><span class="fl">10</span>, mean<span class="op">=</span><span class="fl">5</span>, sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">10000</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="thinning-the-normal-distribution-with-unknown-mean">Thinning the normal distribution with unknown mean<a class="anchor" aria-label="anchor" href="#thinning-the-normal-distribution-with-unknown-mean"></a>
</h3>
<p>We first apply data thinning assuming that <span class="math inline">\(\sigma^2=2\)</span> is known. This is passed in as
the <code>arg</code> parameter. We can see that, after applying data
thinning, each column of the training set is independent of each column
in the test set (once again, we are using small empirical correlations
as evidence of independence).</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"normal"</span>, arg<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="va">cors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">[</span>,<span class="va">u</span><span class="op">]</span>, <span class="va">dat.test</span><span class="op">[</span>,<span class="va">u</span><span class="op">]</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Correlation between train and test in column"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="st">":"</span>, <span class="va">cors</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">##  [1] "Correlation between train and test in column 1 : -0.005" </span></span>
<span><span class="co">##  [2] "Correlation between train and test in column 2 : 0.0075" </span></span>
<span><span class="co">##  [3] "Correlation between train and test in column 3 : 0.0153" </span></span>
<span><span class="co">##  [4] "Correlation between train and test in column 4 : -0.0066"</span></span>
<span><span class="co">##  [5] "Correlation between train and test in column 5 : 0.0138" </span></span>
<span><span class="co">##  [6] "Correlation between train and test in column 6 : -0.0038"</span></span>
<span><span class="co">##  [7] "Correlation between train and test in column 7 : 0.0267" </span></span>
<span><span class="co">##  [8] "Correlation between train and test in column 8 : 0.019"  </span></span>
<span><span class="co">##  [9] "Correlation between train and test in column 9 : -0.0013"</span></span>
<span><span class="co">## [10] "Correlation between train and test in column 10 : -0.009"</span></span></code></pre></div>
<p>The parameter <code>arg</code> must either be a scalar (in which case
it is assumed that all elements of the data matrix have the same value
of <span class="math inline">\(\sigma^2\)</span>), or its dimensions
must match that of the data.</p>
<p>We now explore the impact of using the “wrong” value of <span class="math inline">\(\sigma^2\)</span> while splitting. We generate a
dataset with <span class="math inline">\(100,000\)</span> rows and <span class="math inline">\(3\)</span> columns. In the first column, the data
are from a <span class="math inline">\(N(5, 0.1)\)</span> distribution.
In the second column, they are from a <span class="math inline">\(N(5,2)\)</span> distribution. In the final column,
they are from a <span class="math inline">\(N(5,20)\)</span>
distribution.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100000</span>, mean<span class="op">=</span><span class="fl">5</span>, sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100000</span>, mean<span class="op">=</span><span class="fl">5</span>, sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100000</span>, mean<span class="op">=</span><span class="fl">5</span>, sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>First, we datathin but we incorrectly assume that all items in the
matrix have <span class="math inline">\(\sigma^2=2\)</span>. We see that
we have negative correlation between the training and test sets in the
first column (where we used a value of <span class="math inline">\(\sigma^2\)</span> that was too big), no
correlation in the second column (where we used the correct value of
<span class="math inline">\(\sigma^2\)</span>), and positive correlation
in the last column (where we used a value of <span class="math inline">\(\sigma^2\)</span> that was too small). See our <a href="https://arxiv.org/abs/2301.07276" class="external-link">preprint</a> for further
explanation of this property.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"normal"</span>, arg<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">cors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">[</span>,<span class="va">u</span><span class="op">]</span>, <span class="va">dat.test</span><span class="op">[</span>,<span class="va">u</span><span class="op">]</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Correlation between train and test in column"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="st">":"</span>, <span class="va">cors</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] "Correlation between train and test in column 1 : -0.9053"</span></span>
<span><span class="co">## [2] "Correlation between train and test in column 2 : 0.0078" </span></span>
<span><span class="co">## [3] "Correlation between train and test in column 3 : 0.8191"</span></span></code></pre></div>
<p>To remedy the situation, we must let <code>arg</code> be a matrix
that stores the correct <span class="math inline">\(\sigma^2\)</span>
values.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">good_args</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">100000</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">100000</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">100000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"normal"</span>, arg<span class="op">=</span><span class="va">good_args</span><span class="op">)</span></span>
<span><span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">cors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">u</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">[</span>,<span class="va">u</span><span class="op">]</span>, <span class="va">dat.test</span><span class="op">[</span>,<span class="va">u</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Correlation between train and test in column"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="st">":"</span>, <span class="va">cors</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] "Correlation between train and test in column 1 : 9e-04" </span></span>
<span><span class="co">## [2] "Correlation between train and test in column 2 : 0.0066"</span></span>
<span><span class="co">## [3] "Correlation between train and test in column 3 : 0.0051"</span></span></code></pre></div>
<p>We quickly note that an error will be thrown if <code>arg</code> is
not a scalar and its dimensions do not match those of the data. The
following code results in an error:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"normal"</span>, arg<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">2</span>,<span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="thinning-the-normal-distribution-with-unknown-variance">Thinning the normal distribution with unknown variance<a class="anchor" aria-label="anchor" href="#thinning-the-normal-distribution-with-unknown-variance"></a>
</h3>
<p>We can also thin the normal distribution with unknown variance by
recognizing that for <span class="math inline">\(X\sim
N(\mu,\sigma^2)\)</span>, <span class="math inline">\((X-\mu)^2 \sim
\sigma^2 \chi_1^2 =
\text{Gamma}\left(\frac{1}{2},\frac{1}{2\sigma^2}\right)\)</span>. In
other words, we can convert our normal data with knonw mean into gamma
data with known shape, thus allowing us to apply gamma data thinning.
This is an example of indirect thinning; see our second <a href="https://arxiv.org/abs/2303.12931" class="external-link">preprint</a> for more
details.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10000</span><span class="op">*</span><span class="fl">10</span>, mean<span class="op">=</span><span class="fl">5</span>, sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">10000</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] 1.989115</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"normal-variance"</span>, arg<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.9877177</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.test</span><span class="op">)</span></span>
<span><span class="co">## [1] 1.001414</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">dat.test</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.000388819</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="negative-binomial">Negative binomial<a class="anchor" aria-label="anchor" href="#negative-binomial"></a>
</h2>
<p>We generate data from a negative binomial distribution. We use the
mean and overdispersion parameterization of the negative binomial
distribution.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom</a></span><span class="op">(</span><span class="fl">100000</span>, size<span class="op">=</span><span class="fl">7</span>, mu <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"negative binomial"</span>, epsilon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">0.8</span><span class="op">)</span>, arg<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="fl">0.2</span><span class="op">*</span><span class="fl">6</span></span>
<span><span class="co">## [1] 1.2</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span></span>
<span><span class="co">## [1] 1.19873</span></span>
<span><span class="fl">0.8</span><span class="op">*</span><span class="fl">6</span></span>
<span><span class="co">## [1] 4.8</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.test</span><span class="op">)</span></span>
<span><span class="co">## [1] 4.80254</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat.train</span>, <span class="va">dat.test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] -0.001117663</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="binomial">Binomial<a class="anchor" aria-label="anchor" href="#binomial"></a>
</h2>
<p>We verify the same properties as above, assuming that the size
parameter is known. Note that, if we want to use <span class="math inline">\(\epsilon=0.5\)</span>, the size parameter of the
binomial distribution must be an even number.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">10000</span>, <span class="fl">16</span>, <span class="fl">0.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">## [1] 3.98</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"binomial"</span>, arg<span class="op">=</span><span class="fl">16</span><span class="op">)</span></span>
<span><span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span></span>
<span><span class="co">## [1] 2.0008</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat.test</span><span class="op">)</span></span>
<span><span class="co">## [1] 1.9792</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat.train</span>, <span class="va">dat.test</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] -0.009440734</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="additional-gamma-families">Additional gamma families<a class="anchor" aria-label="anchor" href="#additional-gamma-families"></a>
</h2>
<p>The gamma distributions is extremely flexible, and shows up in many
thinning recipes. Indeed, we saw this above when we thinned the normal
distribution with unknown variance using the gamma distribution. Here we
showcase similar strategies that also use the gamma distribution in some
way; see our second <a href="https://arxiv.org/abs/2303.12931" class="external-link">preprint</a> for further
details.</p>
<div class="section level3">
<h3 id="chi-squared">Chi-squared<a class="anchor" aria-label="anchor" href="#chi-squared"></a>
</h3>
<p>The chi-squared distribution is a special case of the gamma
distribution, where the shape is equal to half of the degrees of
freedom. Using this relationship, we can thin a scaled chi-squared
distribution with <span class="math inline">\(K\)</span> degrees of
freedom into <span class="math inline">\(K\)</span> normal random
variables.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fl">3</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">rchisq</a></span><span class="op">(</span><span class="fl">10000</span>, df<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">/</span><span class="fl">5</span></span>
<span><span class="co">## [1] 2.997949</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"chi-squared"</span>, K<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">dat1</span><span class="op">)</span></span>
<span><span class="co">## [1] 3.025864</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span></span>
<span><span class="co">## [1] 2.983546</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat1</span>, <span class="va">dat2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] -0.009146341</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="gamma-weibull">Gamma-Weibull<a class="anchor" aria-label="anchor" href="#gamma-weibull"></a>
</h3>
<p>Similarly, we can thin the gamma distribution into the Weibull
distribution.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">10000</span>, shape<span class="op">=</span><span class="fl">4</span>, rate<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"gamma-weibull"</span>, K<span class="op">=</span><span class="fl">4</span>, arg<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Expected mean:"</span>, <span class="op">(</span><span class="fl">4</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Special.html" class="external-link">gamma</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] "Expected mean: 0.56254184187547"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat1</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.5616192</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.564796</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat1</span>, <span class="va">dat2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] -0.01063155</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="weibull">Weibull<a class="anchor" aria-label="anchor" href="#weibull"></a>
</h3>
<p>We can also thin the Weibull distribution with known shape into gamma
random variables.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Weibull.html" class="external-link">rweibull</a></span><span class="op">(</span><span class="fl">100000</span>, <span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"weibull"</span>, K<span class="op">=</span><span class="fl">2</span>, arg<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Expected mean:"</span>, <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="fl">2</span><span class="op">^</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] "Expected mean: 16"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat1</span><span class="op">)</span></span>
<span><span class="co">## [1] 15.93477</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span></span>
<span><span class="co">## [1] 15.98874</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat1</span>, <span class="va">dat2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.00400066</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="pareto">Pareto<a class="anchor" aria-label="anchor" href="#pareto"></a>
</h3>
<p>Similarly, we can thin the Pareto distribution with known scale into
gamma random variables.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/extraDistr/man/Pareto.html" class="external-link">rpareto</a></span><span class="op">(</span><span class="fl">100000</span>, <span class="fl">6</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"pareto"</span>, K<span class="op">=</span><span class="fl">2</span>, arg<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Expected mean:"</span>, <span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] "Expected mean: 0.0833333333333333"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat1</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.08343128</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.08318186</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat1</span>, <span class="va">dat2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] -0.001256507</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="multivariate-distributions">Multivariate distributions<a class="anchor" aria-label="anchor" href="#multivariate-distributions"></a>
</h2>
<p>Data thinning recipes are also available for a subset of multivariate
distributions. In both of the following distributions, care must be
taken when providing the known parameter.</p>
<div class="section level3">
<h3 id="multivariate-normal">Multivariate normal<a class="anchor" aria-label="anchor" href="#multivariate-normal"></a>
</h3>
<p>As the multivariate normal distribution is vector-valued, each row of
the <span class="math inline">\(n \times p\)</span> <code>data</code>
matrix corresponds to one observation. To thin this data, we must
provide the covariance matrix to the <code>datathin</code> function.
Either <code>arg</code> can be a single <span class="math inline">\(p
\times p\)</span> covariance matrix, or a <span class="math inline">\(n
\times p \times p\)</span> array of covariance matrices.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0.6</span></span>
<span><span class="va">Sig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="fl">4</span>, ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Sig</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">rho</span><span class="op">^</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="va">j</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">100000</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>, <span class="va">Sig</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.9955463 1.9997193 2.9981161 3.9996550</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"mvnormal"</span>, arg<span class="op">=</span><span class="va">Sig</span><span class="op">)</span></span>
<span><span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.499857 1.000230 1.496200 1.999099</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">dat.test</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.4956893 0.9994894 1.5019156 2.0005555</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat.train</span>, <span class="va">dat.test</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.005323221</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multinomial">Multinomial<a class="anchor" aria-label="anchor" href="#multinomial"></a>
</h3>
<p>For the multinomial distribution, each row of the <span class="math inline">\(n\times p\)</span> data matrix represents a
realization from the multinomial distribution. The input to
<code>arg</code> is then either a scalar, or a vector of length <span class="math inline">\(n\)</span>. Similar to the binomial distribution,
the symmetric folds require an even number of trials.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Multinom.html" class="external-link">rmultinom</a></span><span class="op">(</span><span class="fl">100000</span>, <span class="fl">20</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="co">## [1] 1.99914 4.00629 5.99685 7.99772</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"multinomial"</span>, arg<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="va">dat.train</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">dat.test</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">dat.train</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.99864 2.00189 2.99914 4.00033</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="va">dat.test</span><span class="op">)</span></span>
<span><span class="co">## [1] 1.00050 2.00440 2.99771 3.99739</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat.train</span>, <span class="va">dat.test</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.003064689</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="shift-and-scale-families">Shift and scale families<a class="anchor" aria-label="anchor" href="#shift-and-scale-families"></a>
</h2>
<p>Outside of the exponential family, certain shift and scale families
can also be thinned.</p>
<div class="section level3">
<h3 id="scaled-beta">Scaled beta<a class="anchor" aria-label="anchor" href="#scaled-beta"></a>
</h3>
<p>When <span class="math inline">\(X\sim \theta
\text{Beta}(\alpha,1)\)</span>, <span class="math inline">\(X\)</span>
can be thinned so long as <span class="math inline">\(\alpha\)</span> is
known. If <span class="math inline">\(\alpha=1\)</span>, then this
reduces to the simpler setting of thinning <span class="math inline">\(X\sim\text{Uniform}(0,\theta)\)</span>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fl">10</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">100000</span>, <span class="fl">7</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"scaled-beta"</span>, K<span class="op">=</span><span class="fl">2</span>, arg<span class="op">=</span><span class="fl">7</span><span class="op">)</span></span>
<span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Expected mean:"</span>, <span class="fl">10</span><span class="op">*</span><span class="op">(</span><span class="fl">7</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">7</span><span class="op">/</span><span class="fl">2</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] "Expected mean: 7.77777777777778"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat1</span><span class="op">)</span></span>
<span><span class="co">## [1] 7.77505</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span></span>
<span><span class="co">## [1] 7.780858</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat1</span>, <span class="va">dat2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.003765505</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="shifted-exponential">Shifted exponential<a class="anchor" aria-label="anchor" href="#shifted-exponential"></a>
</h3>
<p>We can also thin a shifted exponential, assuming that the rate is
known.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fl">6</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">100000</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/datathin.html">datathin</a></span><span class="op">(</span><span class="va">dat</span>, family<span class="op">=</span><span class="st">"shifted-exponential"</span>, K<span class="op">=</span><span class="fl">2</span>, arg<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">dat2</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">[</span>,,<span class="fl">2</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Expected mean:"</span>, <span class="fl">6</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] "Expected mean: 7"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat1</span><span class="op">)</span></span>
<span><span class="co">## [1] 6.993169</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">dat2</span><span class="op">)</span></span>
<span><span class="co">## [1] 7.004156</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">dat1</span>, <span class="va">dat2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">## [1] 0.0007561852</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Anna Neufeld, Ameer Dharamshi.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
